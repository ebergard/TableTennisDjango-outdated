{% extends "base.html" %}

{% block title %}Games{% endblock %}

{% block menu %}
{% if tournament_status == 0 or tournament_status == 1 or tournament_status == 2 %}
    {% if tournament.number_of_participants > 0  %}
        <a class="nav-link" href="/participants">Участники</a>
    {% endif %}
{% endif %}
{% if tournament_status == 1 or tournament_status == 2 %}
    <a class="nav-link" href="/games">Игры</a>
    <a class="nav-link" href="/rating">Рейтинг</a>
{% endif %}
{% endblock %}

{% block content %}
<h3 class="cover-heading">Расписание игр:</h3>
<p>
<table class="table table-dark">
    <tbody>
    {% for g in games %}
        <form action="{% url 'game' g.id %}" method="post">
        {% csrf_token %}
        {{ form.non_field_errors }}
        <tr>
            <th scope="row">{{ g.game_date }}</th>
            <td>{{ g.start_time|time:'H:i' }}</td>
            <td>{{ g.participant1 }}</td>
            <td>
                {% if g.setresult_set.all %}
                    <table style="width: 100%; align:justify;"><tr>
                    {% for r in g.setresult_set.all %}
                        <td style="width: 20%; border: 0px">
                            {{ r.result1 }}
                        </td>
                    {% endfor %}
                    </tr></table>
                {% else %}
                    <div class="form-group">
                    {{ form.set1res1.errors }}
                    {{ form.set1res1 }}
                    {{ form.set2res1.errors }}
                    {{ form.set2res1 }}
                    {{ form.set3res1.errors }}
                    {{ form.set3res1 }}
                    {{ form.set4res1.errors }}
                    {{ form.set4res1 }}
                    {{ form.set5res1.errors }}
                    {{ form.set5res1 }}
                    </div>
                {% endif %}
            </td>
        </tr>
        <tr>
            <th scope="row"></th>
            <td></td>
            <td>{{ g.participant2 }}</td>
            <td>
                {% if g.setresult_set.all %}
                    <table style="width: 100%; align:justify;"><tr>
                    {% for r in g.setresult_set.all %}
                        <td style="width: 20%; border: 0px">
                            {{ r.result2 }}
                        </td>
                    {% endfor %}
                    </tr></table>
                {% else %}
                    <div class="form-group">
                    {{ form.set1res2.errors }}
                    {{ form.set1res2 }}
                    {{ form.set2res2.errors }}
                    {{ form.set2res2 }}
                    {{ form.set3res2.errors }}
                    {{ form.set3res2 }}
                    {{ form.set4res2.errors }}
                    {{ form.set4res2 }}
                    {{ form.set5res2.errors }}
                    {{ form.set5res2 }}
                    </div>
                    <input type="submit" value="Отправить результат" class="btn btn-secondary btn-sm">
                {% endif %}
                </td>
        </tr>
        </form>
    {% endfor %}
    </tbody>
</table>
</p>
{% endblock %}
